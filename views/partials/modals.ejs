<!-- views/partials/modals.ejs -->

<!-- IMPORTANT: REMOVED THE <style> BLOCK THAT WAS PREVIOUSLY HERE. -->
<!-- All modal-related CSS is now in public/css/style.css -->

<!-- BUY TOKENS MODAL -->
<!-- This modal already uses .modal-content, which gets its background from style.css -->
<div id="buy-tokens-modal" class="modal hidden fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center">
  <div class="modal-backdrop"></div>
  <div class="modal-content w-full max-w-md mx-auto relative">
    <button
      id="close-buy-tokens-modal"
      class="absolute top-2 right-2 text-gray-400 hover:text-gray-300 text-2xl"
    >×</button>
    <h2 class="text-xl font-bold mb-4">Manage PIXZOR Credits</h2>
    <form id="buy-tokens-form" class="mb-6">
      <label for="token-bundle" class="block mb-2">Select a Credit Bundle:</label>
      <select
        id="token-bundle"
        class="w-full border rounded-lg p-2 mb-4 bg-gray-700 text-gray-200"
      >
        <option value="3" data-price="3.00">3 Credits - £3.00</option>
        <option value="5" data-price="5.00">5 Credits - £5.00</option>
        <option value="10" data-price="10.00">10 Credits - £10.00</option>
        <option value="20" data-price="20.00">20 Credits - £20.00</option>
        <option value="30" data-price="30.00">30 Credits - £30.00</option>
        <option value="50" data-price="50.00">50 Credits - £50.00</option>
        <option value="100" data-price="100.00">100 Credits - £100.00</option>
      </select>
      <button
        type="submit"
        class="w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-500"
      >
        Purchase Credits
      </button>
    </form>
  </div>
</div>

<!-- WELCOME MODAL -->
<!-- This modal already uses .modal-content, which gets its background from style.css -->
<div id="welcome-modal" class="modal hidden fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center">
  <div class="modal-backdrop"></div>
  <div class="modal-content w-full max-w-md mx-auto p-6 rounded-lg shadow-lg relative">
    <button
      id="close-welcome-modal"
      class="absolute top-2 right-2 text-gray-400 hover:text-gray-300 text-2xl"
    >
      ×
    </button>
    <h2 class="text-xl font-bold mb-4">Welcome to Pixzor!</h2>
    <p class="mb-4">
      Register now to claim your <strong>$2.00 free credits</strong>...
    </p>
    <div class="flex justify-end space-x-4">
      <button
        id="close-welcome-modal-btn"
        class="bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded"
      >
        Close
      </button>
      <button
        id="register-with-google"
        class="bg-green-600 hover:bg-green-500 text-white px-4 py-2 rounded"
      >
        Register with Google
      </button>
    </div>
  </div>
</div>

<!-- ABOUT POPUP -->
<!-- This modal already uses .modal-content, which gets its background from style.css -->
<div id="about-popup" class="modal hidden fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center">
    <div class="modal-backdrop"></div>
    <div class="modal-content w-full max-w-md mx-auto relative p-6 rounded-lg">
        <button id="close-about-popup" class="absolute top-2 right-2 text-gray-400 hover:text-gray-300 text-2xl">×</button>
        <h2 class="text-xl font-bold mb-4">About Pixzor</h2>
        <p class="line-height-1.5 mb-4">Pixzor is an AI-powered platform designed to bring your creative ideas to life with cutting-edge tools.</p>
        <p class="line-height-1.5 mb-4">
            For inquiries:
            <a href="mailto:contact@pixzor.com" class="text-blue-400 hover:text-blue-300">contact@pixzor.com</a>
        </p>
        <footer class="bg-gray-900 p-4 rounded-b-lg -mx-6 -mb-6">
            <p class="line-height-1.5 mb-0">
                By using Pixzor, you agree to our
                <a id="terms-link" href="#" class="text-blue-400 hover:text-blue-300">Terms of Service</a>.
            </p>
        </footer>
        <button id="close-about-popup-btn" class="bg-red-600 hover:bg-red-500 text-white px-4 py-2 rounded block mx-auto mt-4">Close</button>
    </div>
</div>

<!-- FULLSCREEN IMAGE MODAL -->
<!-- The z-index for this modal and its close button is set in style.css for highest priority -->
<div id="fullscreen-modal" class="modal hidden fixed inset-0 flex items-center justify-center bg-black bg-opacity-90">
  <button
    class="absolute top-4 right-6 text-white text-4xl font-bold hover:text-gray-300 z-[10000]" /* Ensure this button is always on top */
    onclick="closeFullscreenModal();"
  >×</button>
  <div class="relative max-w-full max-h-full p-4">
    <img id="fullscreen-image" src="" alt="Fullscreen Image" class="block max-w-full max-h-[90vh] object-contain">
  </div>
</div>

<!-- COMMENTS/DETAILS MODAL -->
<!-- Removed the 'container mx-auto px-4 py-8' wrapper div for simplicity and direct control -->
<!-- This main outer div will get its default modal styles (including backdrop and base z-index) from style.css -->
<div id="comments-modal" class="modal hidden fixed inset-0 bg-black bg-opacity-75">
    <!-- This is the actual modal content box. Applied 'modal-content' class and specific dark Tailwind classes. -->
    <div class="modal-content max-w-4xl mx-auto relative p-6 rounded-lg flex flex-col md:flex-row">
        <!-- Close Button (positioned relative to its parent .modal-content) -->
        <button id="close-comments-modal" class="absolute top-2 right-2 bg-gray-600 text-white hover:bg-gray-500 rounded-full p-1 text-2xl z-30" aria-label="Close Comments Modal">
            ×
        </button>

        <!-- Left Section: Image and Model Info -->
        <!-- Explicitly set background color to a dark gray with Tailwind -->
        <div class="md:w-2/3 bg-gray-900 flex flex-col items-start p-4 relative rounded-l-lg">
            <button id="fullscreen-icon" class="absolute top-2 left-2 bg-black text-white p-1 rounded-full text-sm z-20" aria-label="Fullscreen Image">
                <i class="fas fa-expand"></i>
            </button>
            <img id="modal-image" src="" alt="Full Image" class="w-full h-auto rounded-lg object-contain">
            <div class="w-full mt-4 space-y-2">
                <div id="model-container" class="flex flex-col hidden">
                    <h3 class="text-sm font-semibold text-gray-400">Model</h3>
                    <p id="modal-model" class="text-xs text-gray-500"></p>
                </div>
            </div>
        </div>

        <!-- Right Section: Details and Comments -->
        <!-- Explicitly set background color to a slightly lighter dark gray with Tailwind -->
        <div class="md:w-1/3 p-6 flex flex-col space-y-4 bg-gray-800 rounded-r-lg">
            <!-- Prompt -->
            <div class="flex flex-col">
                <h3 class="text-lg font-bold text-white mb-2 flex items-center">
                    Prompt
                    <button id="copy-prompt" class="ml-2 text-gray-400 hover:text-gray-200" title="Copy Prompt" aria-label="Copy Prompt">
                        <i class="fas fa-copy"></i>
                    </button>
                </h3>
                <!-- Explicitly set background color for the prompt container -->
                <div id="modal-prompt-container" class="border border-gray-600 p-3 rounded max-h-24 overflow-y-auto bg-gray-700 relative">
                    <p id="modal-prompt" class="text-gray-300 pr-8"></p>
                </div>
            </div>

            <!-- User Profile -->
            <div>
                <h3 class="text-lg font-bold text-white">Created By <span id="modal-username" class="text-blue-400"></span></h3>
            </div>

            <!-- Action Buttons (no background changes needed here, as they have specific Tailwind classes) -->
            <div class="flex flex-wrap gap-2">
                <div class="relative group">
                    <a id="download-button" href="#" class="bg-green-600 text-white p-2 rounded flex items-center" download>
                        <i class="fas fa-download"></i>
                    </a>
                    <span class="absolute bottom-full left-1/2 transform -translate-x-1/2 bg-gray-800 text-white text-xs rounded px-2 py-1 opacity-0 group-hover:opacity-100 transition-opacity">Download</span>
                </div>
                <div id="delete-button-container" class="relative group hidden">
                    <button id="delete-button-modal" class="bg-red-600 text-white p-2 rounded flex items-center" aria-label="Delete Content">
                        <i class="fas fa-trash"></i>
                    </button>
                    <span class="absolute bottom-full left-1/2 transform -translate-x-1/2 bg-gray-800 text-white text-xs rounded px-2 py-1 opacity-0 group-hover:opacity-100 transition-opacity">Delete</span>
                </div>
                
                
                  <!-- NEW: Edit Image Button for Modal -->
                <button id="edit-image-modal-button" class="px-3 py-1 bg-green-600 hover:bg-green-700 text-white rounded text-sm transition-colors opacity-60" title="Edit Image">
                    <i class="fas fa-edit mr-1"></i> Edit Image
                </button>
                
                
                
                <div class="relative group">
                    <a id="share-facebook" href="#" target="_blank" class="bg-blue-600 text-white p-2 rounded flex items-center" aria-label="Share on Facebook">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <span class="absolute bottom-full left-1/2 transform -translate-x-1/2 bg-gray-800 text-white text-xs rounded px-2 py-1 opacity-0 group-hover:opacity-100 transition-opacity">Facebook</span>
                </div>
                <div class="relative group">
                    <a id="share-twitter" href="#" target="_blank" class="bg-blue-400 text-white p-2 rounded flex items-center" aria-label="Share on Twitter">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <span class="absolute bottom-full left-1/2 transform -translate-x-1/2 bg-gray-800 text-white text-xs rounded px-2 py-1 opacity-0 group-hover:opacity-100 transition-opacity">Twitter</span>
                </div>
                <div class="relative group">
                    <a id="share-pinterest" href="#" target="_blank" class="bg-red-600 text-white p-2 rounded flex items-center" aria-label="Share on Pinterest">
                        <i class="fab fa-pinterest-p"></i>
                    </a>
                    <span class="absolute bottom-full left-1/2 transform -translate-x-1/2 bg-gray-800 text-white text-xs rounded px-2 py-1 opacity-0 group-hover:opacity-100 transition-opacity">Pinterest</span>
                </div>
            </div>

            <!-- Comments Section -->
            <div class="flex flex-col flex-grow overflow-hidden">
                <h3 class="text-lg font-bold text-white mb-2">Comments</h3>
                <!-- Explicitly set background color for the comments list -->
                <div class="flex-grow overflow-y-auto mb-4">
                    <ul id="comments-list" class="space-y-2 max-h-40 overflow-y-auto border border-gray-600 p-2 rounded bg-gray-700"></ul>
                </div>
                <div class="mt-auto">
                    <!-- Explicitly set background color for the comment input -->
                    <textarea id="comment-input" placeholder="Login to comment..."
                           class="w-full p-2 border border-gray-600 rounded text-white bg-gray-700 mb-2" aria-label="Write a comment" disabled></textarea>
                    <button id="post-comment"
                            class="w-full bg-green-600 text-white px-4 py-2 rounded disabled:opacity-50" aria-label="Post Comment" disabled>
                        Post
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="/js/payment.js"></script>