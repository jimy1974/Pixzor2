"use strict";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("is-retry-allowed"));function r(e){return!e.response&&(!!e.code&&(!["ERR_CANCELED","ECONNABORTED"].includes(e.code)&&t.default(e)))}var o=["get","head","options"],n=o.concat(["put","delete"]);function s(e){return"ECONNABORTED"!==e.code&&(!e.response||e.response.status>=500&&e.response.status<=599)}function u(e){return!!e.config?.method&&(s(e)&&-1!==o.indexOf(e.config.method))}function i(e){return!!e.config?.method&&(s(e)&&-1!==n.indexOf(e.config.method))}function c(e){return r(e)||i(e)}function a(e=0,t=void 0,r=100){const o=2**e*r;return o+.2*o*Math.random()}var d={retries:3,retryCondition:c,retryDelay:function(){return 0},shouldResetTimeout:!1,onRetry:()=>{}};function f(e,t){const r=function(e,t){return{...d,...t,...e.retry}}(e,t||{});return r.retryCount=r.retryCount||0,r.lastRequestTime=r.lastRequestTime||Date.now(),e.retry=r,r}var p=(e,t)=>({requestInterceptorId:e.interceptors.request.use((e=>(f(e,t),e))),responseInterceptorId:e.interceptors.response.use(null,(async r=>{const{config:o}=r;if(!o)return Promise.reject(r);const n=f(o,t);if(await async function(e,t){const{retries:r,retryCondition:o}=e,n=(e.retryCount||0)<r&&o(t);if("object"==typeof n)try{return!1!==await n}catch(e){return!1}return n}(n,r)){n.retryCount+=1;const{retryDelay:t,shouldResetTimeout:s,onRetry:u}=n,i=t(n.retryCount,r);if(!s&&o.timeout&&n.lastRequestTime){const e=Date.now()-n.lastRequestTime,t=o.timeout-e-i;if(t<=0)return Promise.reject(r);o.timeout=t}return o.transformRequest=[e=>e],await u(n.retryCount,r,o),new Promise((t=>{setTimeout((()=>t(e(o))),i)}))}return Promise.reject(r)}))});p.isNetworkError=r,p.isSafeRequestError=u,p.isIdempotentRequestError=i,p.isNetworkOrIdempotentRequestError=c,p.exponentialDelay=a,p.isRetryableError=s;var l=p;exports.DEFAULT_OPTIONS=d,exports.default=l,exports.exponentialDelay=a,exports.isIdempotentRequestError=i,exports.isNetworkError=r,exports.isNetworkOrIdempotentRequestError=c,exports.isRetryableError=s,exports.isSafeRequestError=u;